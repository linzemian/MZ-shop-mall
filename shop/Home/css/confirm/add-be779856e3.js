(function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="/order/",e(0)})(function(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))switch(typeof t[e]){case"function":break;case"object":t[e]=function(e){var i=e.slice(1),s=t[e[0]];return function(t,e,n){s.apply(this,[t,e,n].concat(i))}}(t[e]);break;default:t[e]=t[t[e]]}return t}([function(t,e,i){i(1);var s=i(7),n=i(8),o=i(12),r=i(16),a=i(26)(),c=i(27),d=i(36),l=i(42),p=s.extend(!0,{},window.global.data),u=s("#totalOrderPrice"),h=s("#totalExpressPrice"),v=s("#totalPayPrice"),m=s("#validCode"),f=s("#submitForm"),y=s("#totalTips"),g=new n({type:"tips"}),x=null;p.codeRule.display&&(x=new r({selector:m,len:p.codeRule.len,type:p.codeRule.type,sid:p.codeRule.verifySid}).on("click",function(){this.$element.css("width",318)}).on("hide",function(){this.$element.css("width",210)}));var b=function(){var t=d.getCountEndProd(),e=new n({type:"tips",successText:"上一步"}).on("hide",function(){window.location.replace(p.refererUrl)});if(t.length)return e.show({title:"提示",content:t.join(",")+"的价格已发生变化，请重新下单！"}),!1;var i=c.getActiveAddressId();if(null===i)return g.show({title:"提示",content:"请选择收货人地址"}),!1;if(p.codeRule.display&&!x.getValidateState())return y.text("请先通过安全验证"),!1;y.empty();var s=p.codeRule.display?x.getValidateCode():"";k(i,s)},k=function(t,e){var i=d.getProductPointer(),n=s.map(i,function(t){var e={invoiceType:t.invoiceType};return t.invoiceTitle&&(e.invoiceTitle=t.invoiceTitle),t.remark&&(e.remark=t.remark),e.orderItems=s.map(t.skus,function(t){var e={skuId:t.skuId,numbers:t.number};return t.packageId&&(e.packageId=t.packageId,e.packageList=t.packageList),e}),e}),o={mcode:p.mcode,sourceTime:p.sourceTime,validCode:e,addressId:t,skillTicket:p.skillTicket,buyInfos:JSON.stringify(n)};l.repo.getUseRepoCount()>0&&(o.mcycleTickets=JSON.stringify(l.repo.getSelectedRepo()));var r=l.coupon.getUseCouponId();r&&(o.couponAcquirementId=r);var a=l.red.getUseRedId();a&&(o.redEnvelopeAcquirementId=a),w(o)},w=function(t){a.get(function(e,i){return e?(g.show({title:"提示",content:e}),void 0):(s.ajax({url:"/order/submit.html",data:t,headers:{"X-CSRF-TOKEN":i},type:"post",timeout:1e4,beforeSend:o.show.bind(null,"body"),success:function(t){o.hide(),200==t.code?window.location.replace(t.data.url):t.code>6e3?g.on("hide",function(){window.location.replace(t.data.url)}).show({title:"提示",content:t.message}):4e3==t.code?g.one("hide",function(){switch(p.codeRule.display&&x.reset(),t.data.failCouponType){case 1:l.repo.clearRepo();break;case 2:l.coupon.clearCoupon();break;case 3:l.red.clearRed();break;default:}}).show({title:"提示",content:t.message}):(p.codeRule.display&&x.reset(),g.show({title:"提示",content:t.message||t.msg}))},error:function(){o.hide(),g.show({title:"提示",content:"网络错误"})}}),void 0)})},C=function(){u.text(p.totalOrderMoney.toFixed(2)),v.text(p.totalOrderPayMoney.toFixed(2)),h.text(p.totalExpressFee.toFixed(2))},$=function(){c.event.on("selectAddress",_),f.on("click",b)},I=function(t){s.each(t,function(t,e){e.arrival=s(d.setArrival({fastArrivalStatus:0})).replaceAll(e.arrival)})},_=function(t){if(d.getSupportFastArrival()){var e=d.getProductPointer();a.get(function(i,n){s.ajax({url:"/order/check_fast_arrival",headers:{"X-CSRF-TOKEN":n},data:{skus:p.skus,provinceId:t.provinceId,cityId:t.cityId,areaId:t.areaId,townId:t.townId},type:"post",timeout:1e4,beforeSend:o.show.bind(null,c.$addressModule),success:function(t){200==t.code?s.each(t.data,function(i){e[i].arrival=s(d.setArrival(t.data[i])).replaceAll(e[i].arrival)}):I(e),o.hide(c.$addressModule)},error:function(){I(),o.hide(c.$addressModule)}})})}};c.init(p.address),d.init(p.buyInfoList,p.sysTime),l.init(p.totalOrderPayMoney,p.discountCoupons,p.redCoupons),C(),$()},function(){},,,,,,function(t){t.exports=meizuStoreGlobal.jquery},function(t,e,i){i(9);var s=i(7),n=i(11),o=function(t){return this._events={},n.apply(this,arguments),this.options=s.extend({},this.defaultOptions,t),this};o.prototype=new n,o.prototype.constructor=o,o.prototype.defaultOptions={type:"dialog",successText:"确定",cancelText:"取消"},o.prototype._create=function(){switch(this.$mask=s('<div class="mz-mask" />'),this.$dialog=s('<div class="mz-dialog" />'),this.$header=s('<div class="mz-dialog-header" />'),this.$content=s('<div class="mz-dialog-content" />'),this.$close=s('<div class="mz-dialog-close" />'),this.$successBtn=s('<div class="mz-btn success" />').text(this.options.successText),this.$cancelBtn=s('<div class="mz-btn cancel" />').text(this.options.cancelText),this.$bottom=s('<div class="mz-dialog-bottom" />'),this.$dialog.append(this.$header,this.$content),this.$mask.append(this.$dialog),this.options.type){case"tips":this.$successBtn.addClass("l"),this.$bottom.append(this.$successBtn),this.$dialog.append(this.$bottom).addClass("tips");break;case"dialog":this.$bottom.append(this.$successBtn,this.$cancelBtn),this.$dialog.append(this.$bottom).addClass("dialog");break;default:this.$dialog.addClass(this.options.type)}return this},o.prototype._bind=function(){var t=this;this.$close.on("click",function(){t.emit("close"),t.hide()}),this.$successBtn.on("click",function(){t.emit("success"),t.hide()}),this.$cancelBtn.on("click",function(){t.emit("cancel"),t.hide()})},o.prototype.setPosition=function(){var t=this.$dialog.outerHeight(),e=this.$dialog.outerWidth();this.$dialog.css({marginLeft:-(e/2),marginTop:-(t/2)})},o.prototype.show=function(t){if(!t)return!1;this.$mask||this._create(),this.$header.empty().append(this.$close,t.title);var e=s('<div class="mz-dialog-content-main" />');if(t.className&&e.addClass(t.className),t.contentTitle&&e.append('<div class="mz-dialog-content-title">'+t.contentTitle+"</div>"),e.append(t.content),this.$content.html(e),this._bind(),t.buttons&&s.isArray(t.buttons)){var i=s.map(t.buttons,function(t){return s('<div class="mz-btn">').addClass(t.type).text(t.text).on("click",t.callback)});this.$bottom.html(i),this.$dialog.append(this.$bottom)}return this.emit("show"),this.$mask.appendTo("body"),this},o.prototype.hide=function(){return this.$mask?(this.emit("hide"),this.$mask.remove(),this):this},t.exports=o},1,,function(t){function e(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function s(t){return"number"==typeof t}function n(t){return"object"==typeof t&&null!==t}function o(t){return void 0===t}t.exports=e,e.EventEmitter=e,e.prototype._events=void 0,e.prototype._maxListeners=void 0,e.defaultMaxListeners=10,e.prototype.setMaxListeners=function(t){if(!s(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},e.prototype.emit=function(t){var e,s,r,a,c,d;if(this._events||(this._events={}),"error"===t&&(!this._events.error||n(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;var l=Error('Uncaught, unspecified "error" event. ('+e+")");throw l.context=e,l}if(s=this._events[t],o(s))return!1;if(i(s))switch(arguments.length){case 1:s.call(this);break;case 2:s.call(this,arguments[1]);break;case 3:s.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),s.apply(this,a)}else if(n(s))for(a=Array.prototype.slice.call(arguments,1),d=s.slice(),r=d.length,c=0;r>c;c++)d[c].apply(this,a);return!0},e.prototype.addListener=function(t,s){var r;if(!i(s))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(s.listener)?s.listener:s),this._events[t]?n(this._events[t])?this._events[t].push(s):this._events[t]=[this._events[t],s]:this._events[t]=s,n(this._events[t])&&!this._events[t].warned&&(r=o(this._maxListeners)?e.defaultMaxListeners:this._maxListeners,r&&r>0&&this._events[t].length>r&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())),this},e.prototype.on=e.prototype.addListener,e.prototype.once=function(t,e){function s(){this.removeListener(t,s),n||(n=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var n=!1;return s.listener=e,this.on(t,s),this},e.prototype.removeListener=function(t,e){var s,o,r,a;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(s=this._events[t],r=s.length,o=-1,s===e||i(s.listener)&&s.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(n(s)){for(a=r;a-->0;)if(s[a]===e||s[a].listener&&s[a].listener===e){o=a;break}if(0>o)return this;1===s.length?(s.length=0,delete this._events[t]):s.splice(o,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},e.prototype.removeAllListeners=function(t){var e,s;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(s=this._events[t],i(s))this.removeListener(t,s);else if(s)for(;s.length;)this.removeListener(t,s[s.length-1]);return delete this._events[t],this},e.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},e.prototype.listenerCount=function(t){if(this._events){var e=this._events[t];if(i(e))return 1;if(e)return e.length}return 0},e.listenerCount=function(t,e){return t.listenerCount(e)}},function(t,e,i){i(13);var s=i(7),n=i(15)("animation"),o='<div class="mz-loading-mask" />',r='<div class="mz-loading" />',a=['<div class="mz-bounce mz-bounce1"></div>','<div class="mz-bounce mz-bounce2"></div>','<div class="mz-bounce mz-bounce3"></div>'].join(""),c=function(t){var e=s(t||"body");"static"===e.css("position")&&e.css("position","relative");var i=e.children(".mz-loading-mask");if(i.length)return i;var c=s(o),d=e.outerHeight(),l=e.outerWidth();return c.css({width:l,height:d}),i=n?s(r).addClass("spinner").append(a):s(r).addClass("image"),c.append(i).appendTo(e)},d=function(t){var e=s(t||"body"),i=e.children(".mz-loading-mask");return i.length?i.remove():!1};t.exports={show:c,hide:d}},1,,function(t){t.exports=function(t){var e,i=["webkit","Moz","ms","o"],s=[],n=document.documentElement.style,o=function(t){return t.replace(/-(\w)/g,function(t,e){return e.toUpperCase()})};for(e=0;i.length>e;e++)s.push(o(i[e]+"-"+t));for(s.push(o(t)),e=0;s.length>e;e++)if(s[e]in n)return!0;return!1}},function(t,e,i){i(17);var s=i(7),n=i(19),o=i(11),r=i(25),a=function(){return this._events={},o.apply(this,arguments),this.getImgCount=new r,this.validatedCount=new r,arguments.length>0?this.init.apply(this,arguments):this};a.prototype=new o,a.prototype.constructor=a,a.prototype.init=function(t){var e=this;return this.options=s.extend({},this.defaultOptions,t),this.imgProportion=350/300,this.validated=!1,this.code=null,this.isShowOpener=!1,this.clickPoint=[],this.$element=s('<div class="mz-captcha-input" tabindex="11" hidefocus="true">'+this.texts.hide+"</div>").appendTo(t.selector),280!==this.options.width&&this.$element.css("width",this.options.width),this.$open=s('<div class="mz-captcha-open" tabindex="10" hidefocus="true" />').hide(),this.$tips=s('<div class="mz-captcha-tips">'+this.texts.def+"</div>"),this.$readImgBox=s('<div class="mz-captcha-read" />'),this.$reload=s('<div class="mz-captcha-reload" />'),this.$validate=s('<div class="mz-btn success">验证</div>'),this.$clickImgBox=s('<div class="mz-captcha-click-img" />'),this.$clickBox=s('<div class="mz-captcha-click-box" />'),this.$top=s('<div class="mz-captcha-open-top" />'),this.$center=s('<div class="mz-captcha-open-center" />'),this.$bottom=s('<div class="mz-captcha-open-bottom">'),this.$top.append(this.$tips,this.$readImgBox),this.$center.append(this.$clickImgBox,this.$clickBox),this.$bottom.append(this.$reload,this.$validate),this.$open.append(this.$top,this.$center,this.$bottom).appendTo("body"),this.on("validate",function(t,i){t?e.$element.html(e.texts.validated).addClass("validated"):(e.updateCaptcha(),e.$element.html(e.texts.hide).removeClass("validated")),e.validated=t,e.code=i}),this.on("show",function(){e.isShowOpener=!0,e.validated?e.$element.html(e.texts.validated):e.$element.html(e.texts.unverified)}),this.on("hide",function(){e.isShowOpener=!1,e.validated?e.$element.html(e.texts.validated):e.$element.html(e.texts.hide)}),this.getImgCount.on("end",function(){e.updateCaptcha()}),this.validatedCount.on("end",function(){e.emit("validate",!1)}),this._bind(),this},a.prototype.getValidateState=function(){return this.validated},a.prototype.getValidateCode=function(){return this.code},a.prototype.reset=function(){this.validatedCount.stop(),this.removePoint(),this.emit("validate",!1)},a.prototype._setPosition=function(){var t=this.$element.offset(),e=s(window).scrollTop()+s(window).height(),i=0,n=265;return i=n>t.top||e>n+t.top?t.top+this.$element.height():t.top-n,this.$open.css({top:i,left:t.left,width:this.$element.outerWidth()-2}),this},a.prototype.defaultOptions={imgPrefix:"//store-server.meizu.com/captcha/get",type:6,len:5,sid:null,width:280,timeout:120},a.prototype.texts={def:"请按顺序点击大图中的文字",click:"再次点击图标可取消重选",over:"您以通过验证，无需重复验证",unverified:"安全验证",hide:"点击完成验证",validated:'<i class="mz-captcha-shield"></i>验证通过'},a.prototype._getImg=function(){var t=n.format({query:{type:this.options.type,len:this.options.len,sid:this.options.sid,_t:+new Date}}),e=n.resolve(this.options.imgPrefix,t);return'<img src="'+e+'" class="mz-captcha-img" alt="验证码" />'},a.prototype.updateCaptcha=function(){if(!this.isShow)return!1;var t=this._getImg();this.$readImgBox.html(t),this.$clickImgBox.html(t),this.removePoint(),this.getImgCount.counting&&this.getImgCount.stop(),this.getImgCount.count(this.options.timeout)},a.prototype.show=function(){this._setPosition(),this.$element.addClass("focus"),this.isShow=!0,0===this.getImgCount.options.time&&this.updateCaptcha(),this.$open.show(),this.emit("show")},a.prototype.hide=function(){this.isShow=!1,this.$element.removeClass("focus"),this.$open.hide(),this.emit("hide")},a.prototype.createPoint=function(t,e){if(4==this.clickPoint.length)return!1;var i=this.clickPoint.length+1,n=s('<div class="mz-captcha-click-point" data-index="'+i+'" />');return n.css({top:e-20,left:t-20}),this.clickPoint.push({x:e,y:t,e:n[0]}),this.$tips.html(this.texts.click).removeClass("error"),n},a.prototype.removePoint=function(t){var e=0;if(t){var i=!1;this.clickPoint.forEach(function(n,o){n.e===t&&(e=o,i=!0),i&&s(n.e).remove()})}else this.$clickBox.empty();this.clickPoint.splice(e,4),0===e&&this.$tips.html(this.texts.def)},a.prototype.check=function(){var t=this,e="";this.clickPoint.forEach(function(i){var s=i.y*t.imgProportion,n=i.x*t.imgProportion;e+=s+","+n+";"}),s.ajax({url:"//store-server.meizu.com/check_choice_captcha",type:"post",data:{sid:this.options.sid,captcha:e},contentType:"text/plain",success:function(e){t.removePoint(),200===e.status?(t.hide(),t.emit("validate",!0,e.randstr),t.validatedCount.count(t.options.timeout)):(t.emit("validate",!1),t.$tips.html(e.error).addClass("error"))}})},a.prototype._bind=function(){var t=this;this.$reload.on("click",function(){t.updateCaptcha()}),this.$element.on("click",function(){t.isShow?t.hide():t.validated||(t.emit("click"),t.show())}),this.$element.on("blur",function(e){s(document).one("click",function(e){s(e.target).parents(".mz-captcha-open").length&&clearTimeout(t.blurTimeout)}),e.relatedTarget!==t.$open[0]&&(t.blurTimeout=setTimeout(function(){t.emit("blur"),t.hide()},500))}),this.$open.on("blur",function(){t.emit("blur"),t.hide()}),this.$clickBox.on("click",function(e){if(e.target===this){var i=t.createPoint(e.offsetX,e.offsetY);i&&i.appendTo(this),4===t.clickPoint.length&&t.check()}else t.removePoint(e.target)}),this.$validate.on("click",function(){t.clickPoint.length&&!t.validated?t.check():t.validated?t.$tips.html(t.texts.over).addClass("error"):t.clickPoint.length||t.$tips.html(t.texts.def).addClass("error")}),s(window).on("resize",function(){t.isShowOpener&&(clearTimeout(t.resizeTimeout),t.resizeTimeout=setTimeout(function(){t._setPosition()},100))})},t.exports=a},1,,function(t,e,i){function s(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function n(t,e,i){if(t&&d(t)&&t instanceof s)return t;var n=new s;return n.parse(t,e,i),n}function o(t){return c(t)&&(t=n(t)),t instanceof s?t.format():s.prototype.format.call(t)}function r(t,e){return n(t,!1,!0).resolve(e)}function a(t,e){return t?n(t,!1,!0).resolveObject(e):e}function c(t){return"string"==typeof t}function d(t){return"object"==typeof t&&null!==t}function l(t){return null===t}function p(t){return null==t}var u=i(20);e.parse=n,e.resolve=r,e.resolveObject=a,e.format=o,e.Url=s;var h=/^([a-z0-9.+-]+:)/i,v=/:[0-9]*$/,m=["<",">",'"',"`"," ","\r","\n","	"],f=["{","}","|","\\","^","`"].concat(m),y=["'"].concat(f),g=["%","/","?",";","#"].concat(y),x=["/","?","#"],b=255,k=/^[a-z0-9A-Z_-]{0,63}$/,w=/^([a-z0-9A-Z_-]{0,63})(.*)$/,C={javascript:!0,"javascript:":!0},$={javascript:!0,"javascript:":!0},I={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},_=i(22);s.prototype.parse=function(t,e,i){if(!c(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var s=t;s=s.trim();var n=h.exec(s);if(n){n=n[0];var o=n.toLowerCase();this.protocol=o,s=s.substr(n.length)}if(i||n||s.match(/^\/\/[^@\/]+@[^@\/]+/)){var r="//"===s.substr(0,2);!r||n&&$[n]||(s=s.substr(2),this.slashes=!0)}if(!$[n]&&(r||n&&!I[n])){for(var a=-1,d=0;x.length>d;d++){var l=s.indexOf(x[d]);-1!==l&&(-1===a||a>l)&&(a=l)}var p,v;v=-1===a?s.lastIndexOf("@"):s.lastIndexOf("@",a),-1!==v&&(p=s.slice(0,v),s=s.slice(v+1),this.auth=decodeURIComponent(p)),a=-1;for(var d=0;g.length>d;d++){var l=s.indexOf(g[d]);-1!==l&&(-1===a||a>l)&&(a=l)}-1===a&&(a=s.length),this.host=s.slice(0,a),s=s.slice(a),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var f=this.hostname.split(/\./),d=0,T=f.length;T>d;d++){var z=f[d];if(z&&!z.match(k)){for(var O="",A=0,j=z.length;j>A;A++)O+=z.charCodeAt(A)>127?"x":z[A];if(!O.match(k)){var D=f.slice(0,d),S=f.slice(d+1),P=z.match(w);P&&(D.push(P[1]),S.unshift(P[2])),S.length&&(s="/"+S.join(".")+s),this.hostname=D.join(".");break}}}if(this.hostname=this.hostname.length>b?"":this.hostname.toLowerCase(),!m){for(var M=this.hostname.split("."),R=[],d=0;M.length>d;++d){var q=M[d];R.push(q.match(/[^A-Za-z0-9_-]/)?"xn--"+u.encode(q):q)}this.hostname=R.join(".")}var E=this.port?":"+this.port:"",L=this.hostname||"";this.host=L+E,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==s[0]&&(s="/"+s))}if(!C[o])for(var d=0,T=y.length;T>d;d++){var F=y[d],U=encodeURIComponent(F);U===F&&(U=escape(F)),s=s.split(F).join(U)}var K=s.indexOf("#");-1!==K&&(this.hash=s.substr(K),s=s.slice(0,K));var N=s.indexOf("?");if(-1!==N?(this.search=s.substr(N),this.query=s.substr(N+1),e&&(this.query=_.parse(this.query)),s=s.slice(0,N)):e&&(this.search="",this.query={}),s&&(this.pathname=s),I[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var E=this.pathname||"",q=this.search||"";this.path=E+q}return this.href=this.format(),this},s.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",i=this.pathname||"",s=this.hash||"",n=!1,o="";this.host?n=t+this.host:this.hostname&&(n=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(n+=":"+this.port)),this.query&&d(this.query)&&Object.keys(this.query).length&&(o=_.stringify(this.query));var r=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||I[e])&&n!==!1?(n="//"+(n||""),i&&"/"!==i.charAt(0)&&(i="/"+i)):n||(n=""),s&&"#"!==s.charAt(0)&&(s="#"+s),r&&"?"!==r.charAt(0)&&(r="?"+r),i=i.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),r=r.replace("#","%23"),e+n+i+r+s},s.prototype.resolve=function(t){return this.resolveObject(n(t,!1,!0)).format()},s.prototype.resolveObject=function(t){if(c(t)){var e=new s;e.parse(t,!1,!0),t=e}var i=new s;if(Object.keys(this).forEach(function(t){i[t]=this[t]},this),i.hash=t.hash,""===t.href)return i.href=i.format(),i;if(t.slashes&&!t.protocol)return Object.keys(t).forEach(function(e){"protocol"!==e&&(i[e]=t[e])}),I[i.protocol]&&i.hostname&&!i.pathname&&(i.path=i.pathname="/"),i.href=i.format(),i;if(t.protocol&&t.protocol!==i.protocol){if(!I[t.protocol])return Object.keys(t).forEach(function(e){i[e]=t[e]}),i.href=i.format(),i;if(i.protocol=t.protocol,t.host||$[t.protocol])i.pathname=t.pathname;else{for(var n=(t.pathname||"").split("/");n.length&&!(t.host=n.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==n[0]&&n.unshift(""),2>n.length&&n.unshift(""),i.pathname=n.join("/")}if(i.search=t.search,i.query=t.query,i.host=t.host||"",i.auth=t.auth,i.hostname=t.hostname||t.host,i.port=t.port,i.pathname||i.search){var o=i.pathname||"",r=i.search||"";i.path=o+r}return i.slashes=i.slashes||t.slashes,i.href=i.format(),i}var a=i.pathname&&"/"===i.pathname.charAt(0),d=t.host||t.pathname&&"/"===t.pathname.charAt(0),u=d||a||i.host&&t.pathname,h=u,v=i.pathname&&i.pathname.split("/")||[],n=t.pathname&&t.pathname.split("/")||[],m=i.protocol&&!I[i.protocol];if(m&&(i.hostname="",i.port=null,i.host&&(""===v[0]?v[0]=i.host:v.unshift(i.host)),i.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===n[0]?n[0]=t.host:n.unshift(t.host)),t.host=null),u=u&&(""===n[0]||""===v[0])),d)i.host=t.host||""===t.host?t.host:i.host,i.hostname=t.hostname||""===t.hostname?t.hostname:i.hostname,i.search=t.search,i.query=t.query,v=n;else if(n.length)v||(v=[]),v.pop(),v=v.concat(n),i.search=t.search,i.query=t.query;else if(!p(t.search)){if(m){i.hostname=i.host=v.shift();var f=i.host&&i.host.indexOf("@")>0?i.host.split("@"):!1;f&&(i.auth=f.shift(),i.host=i.hostname=f.shift())}return i.search=t.search,i.query=t.query,l(i.pathname)&&l(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.href=i.format(),i}if(!v.length)return i.pathname=null,i.path=i.search?"/"+i.search:null,i.href=i.format(),i;for(var y=v.slice(-1)[0],g=(i.host||t.host)&&("."===y||".."===y)||""===y,x=0,b=v.length;b>=0;b--)y=v[b],"."==y?v.splice(b,1):".."===y?(v.splice(b,1),x++):x&&(v.splice(b,1),x--);if(!u&&!h)for(;x--;x)v.unshift("..");!u||""===v[0]||v[0]&&"/"===v[0].charAt(0)||v.unshift(""),g&&"/"!==v.join("/").substr(-1)&&v.push("");var k=""===v[0]||v[0]&&"/"===v[0].charAt(0);if(m){i.hostname=i.host=k?"":v.length?v.shift():"";var f=i.host&&i.host.indexOf("@")>0?i.host.split("@"):!1;f&&(i.auth=f.shift(),i.host=i.hostname=f.shift())}return u=u||i.host&&v.length,u&&!k&&v.unshift(""),v.length?i.pathname=v.join("/"):(i.pathname=null,i.path=null),l(i.pathname)&&l(i.search)||(i.path=(i.pathname?i.pathname:"")+(i.search?i.search:"")),i.auth=t.auth||i.auth,i.slashes=i.slashes||t.slashes,i.href=i.format(),i},s.prototype.parseHost=function(){var t=this.host,e=v.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},function(t,e,i){var s;(function(t,n){(function(o){function r(t){throw RangeError(D[t])}function a(t,e){for(var i=t.length,s=[];i--;)s[i]=e(t[i]);return s}function c(t,e){var i=t.split("@"),s="";i.length>1&&(s=i[0]+"@",t=i[1]),t=t.replace(j,".");var n=t.split("."),o=a(n,e).join(".");return s+o}function d(t){for(var e,i,s=[],n=0,o=t.length;o>n;)e=t.charCodeAt(n++),e>=55296&&56319>=e&&o>n?(i=t.charCodeAt(n++),56320==(64512&i)?s.push(((1023&e)<<10)+(1023&i)+65536):(s.push(e),n--)):s.push(e);return s}function l(t){return a(t,function(t){var e="";return t>65535&&(t-=65536,e+=M(55296|1023&t>>>10),t=56320|1023&t),e+=M(t)}).join("")}function p(t){return 10>t-48?t-22:26>t-65?t-65:26>t-97?t-97:k}function u(t,e){return t+22+75*(26>t)-((0!=e)<<5)}function h(t,e,i){var s=0;for(t=i?P(t/I):t>>1,t+=P(t/e);t>S*C>>1;s+=k)t=P(t/S);return P(s+(S+1)*t/(t+$))}function v(t){var e,i,s,n,o,a,c,d,u,v,m=[],f=t.length,y=0,g=T,x=_;for(i=t.lastIndexOf(z),0>i&&(i=0),s=0;i>s;++s)t.charCodeAt(s)>=128&&r("not-basic"),m.push(t.charCodeAt(s));for(n=i>0?i+1:0;f>n;){for(o=y,a=1,c=k;n>=f&&r("invalid-input"),d=p(t.charCodeAt(n++)),(d>=k||d>P((b-y)/a))&&r("overflow"),y+=d*a,u=x>=c?w:c>=x+C?C:c-x,!(u>d);c+=k)v=k-u,a>P(b/v)&&r("overflow"),a*=v;e=m.length+1,x=h(y-o,e,0==o),P(y/e)>b-g&&r("overflow"),g+=P(y/e),y%=e,m.splice(y++,0,g)}return l(m)}function m(t){var e,i,s,n,o,a,c,l,p,v,m,f,y,g,x,$=[];for(t=d(t),f=t.length,e=T,i=0,o=_,a=0;f>a;++a)m=t[a],128>m&&$.push(M(m));for(s=n=$.length,n&&$.push(z);f>s;){for(c=b,a=0;f>a;++a)m=t[a],m>=e&&c>m&&(c=m);for(y=s+1,c-e>P((b-i)/y)&&r("overflow"),i+=(c-e)*y,e=c,a=0;f>a;++a)if(m=t[a],e>m&&++i>b&&r("overflow"),m==e){for(l=i,p=k;v=o>=p?w:p>=o+C?C:p-o,!(v>l);p+=k)x=l-v,g=k-v,$.push(M(u(v+x%g,0))),l=P(x/g);$.push(M(u(l,0))),o=h(i,y,s==n),i=0,++s}++i,++e}return $.join("")}function f(t){return c(t,function(t){return O.test(t)?v(t.slice(4).toLowerCase()):t})}function y(t){return c(t,function(t){return A.test(t)?"xn--"+m(t):t})}var g=("object"==typeof e&&e&&!e.nodeType&&e,"object"==typeof t&&t&&!t.nodeType&&t,"object"==typeof n&&n);(g.global===g||g.window===g||g.self===g)&&(o=g);var x,b=2147483647,k=36,w=1,C=26,$=38,I=700,_=72,T=128,z="-",O=/^xn--/,A=/[^\x20-\x7E]/,j=/[\x2E\u3002\uFF0E\uFF61]/g,D={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},S=k-w,P=Math.floor,M=String.fromCharCode;x={version:"1.3.2",ucs2:{decode:d,encode:l},decode:v,encode:m,toASCII:y,toUnicode:f},s=function(){return x}.call(e,i,e,t),!(void 0!==s&&(t.exports=s))})(this)}).call(e,i(21)(t),function(){return this}())},function(t){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children=[],t.webpackPolyfill=1),t}},function(t,e,i){"use strict";e.decode=e.parse=i(23),e.encode=e.stringify=i(24)},function(t){"use strict";function e(t,e){return Object.prototype.hasOwnProperty.call(t,e)}t.exports=function(t,i,s,n){i=i||"&",s=s||"=";var o={};if("string"!=typeof t||0===t.length)return o;var r=/\+/g;t=t.split(i);var a=1e3;n&&"number"==typeof n.maxKeys&&(a=n.maxKeys);var c=t.length;a>0&&c>a&&(c=a);for(var d=0;c>d;++d){var l,p,u,h,v=t[d].replace(r,"%20"),m=v.indexOf(s);m>=0?(l=v.substr(0,m),p=v.substr(m+1)):(l=v,p=""),u=decodeURIComponent(l),h=decodeURIComponent(p),e(o,u)?Array.isArray(o[u])?o[u].push(h):o[u]=[o[u],h]:o[u]=h}return o}},function(t){"use strict";var e=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};t.exports=function(t,i,s,n){return i=i||"&",s=s||"=",null===t&&(t=void 0),"object"==typeof t?Object.keys(t).map(function(n){var o=encodeURIComponent(e(n))+s;return Array.isArray(t[n])?t[n].map(function(t){return o+encodeURIComponent(e(t))}).join(i):o+encodeURIComponent(e(t[n]))}).join(i):n?encodeURIComponent(e(n))+s+encodeURIComponent(e(t)):""}},function(t,e,i){var s=i(7),n=i(11),o=function(){return this._events={},n.apply(this,arguments),this.init.apply(this,arguments)};o.prototype=new n,o.prototype.constructor=o,o.prototype.defaultOptions={time:0,step:1,timeStep:1e3},o.prototype.init=function(t){var e=this;return this.options=s.extend({},this.defaultOptions,t),this.on("count",function(t){e.options.time=t}),0!==this.options.time&&this.count(this.options.time),this},o.prototype.count=function(t,e){if(!e&&this.counting)return!1;var i=this;return this.counting=setTimeout(function(){var e=t-i.options.step;e=e>=0?e:0,i.emit("count",e,t),e>0?i.count(e,!0):(delete i.counting,i.emit("end"))},this.options.timeStep),this},o.prototype.stop=function(){return clearTimeout(this.counting),delete this.counting,this},o.prototype.start=function(){return this.count(this.options.time),this},t.exports=o},function(t,e,i){var s=i(7),n=i(11),o=function(){return this._events={},n.apply(this,arguments),this.init.apply(this,arguments)};o.prototype=new n,o.prototype.constructor=o,o.prototype.init=function(t){return this.options=s.extend({},this.defaultOptions,t),this},o.prototype.defaultOptions={url:"/independent"},o.prototype.get=function(t,e){return t&&s.isFunction(t)?(s.ajax({url:this.options.url,type:"get",cache:!1,async:!e,success:function(e,i,s){if(200==e.code){var n=s.getResponseHeader("X-CSRF-TOKEN");t(null,n)}else t(e.error)},error:function(){t("网络错误")}}),void 0):!1},o.prototype.async=function(){var t="";return this.get(function(e,i){if(e)throw Error(e);t=i},!0),t},t.exports=function(t){return new o(t)}},function(t,e,i){i(28);var s=i(7),n=i(30),o=i(26)(),r=i(12),a=i(31),c=i(8),d=i(11),l=n.template(i(35)),p=!1,u=0,h=null,v=null,m=null,f=!0,y=174,g={name:/^[a-zA-Z|\d|\u0391-\uFFE5]*$/,phone:/^[1][34578][0-9]{9}$/,detail:/^[\u4E00-\u9FA5A-Za-z0-9_\-\,\，\.\。\(\)\（\）\s]+$/},x=s("#addressList"),b=s("#addressAdd"),k=s("#addressModule"),w=s("#orderAddressHasOldTips"),C=s("#orderAddressMore"),$=null,I=new a,_=new c({type:"tips"}),T=new d,z=new c({type:"address-adder"}).on("hide",function(){I.remove()}),O=['<div class="order-address-checkbox-tips">',"因配送地址库升级，提交订单前，请务必完善地址信息，让您享受更好的配送服务。",'<div class="order-address-checkbox-row"><i class="order-address-checkbox-perfect"></i></div>',"</div>"].join(""),A=['<div class="order-address-checkbox-ctrl">','<div class="order-address-checkbox-delete"></div>','<div class="order-address-checkbox-edit"></div>',"</div>"].join(""),j=['<li class="order-address-checkbox add">','<div class="order-address-add-icon"></div>','<div class="order-address-add-text">添加新地址</div>',"</li>"].join(""),D=n.template(['<li class="order-address-checkbox <%= className %>">','<div class="order-address-checkbox-top">','<div class="order-address-checkbox-name" title="<%= receiver %>"><%= receiver %></div>','<div class="order-address-checkbox-phone"><%= telNumber %></div>',"</div>",'<div class="order-address-checkbox-content"><%= completeAddress %></div>','<div class="order-address-checkbox-checked">','<div class="order-address-checkbox-tick"></div>',"</div>","<%= ctrlHtml %><%= tipsHtml %>","</li>"].join("")),S=function(){p||(x.find(".order-address-checkbox.add").remove(),u>3&&10>u&&f?s(j).insertAfter(x.children().eq(2)):10>u&&s(j).appendTo(x),f?x.css({height:y}):x.css({height:Math.ceil((u+1)/4)*y}),f&&u>3&&C.css("display","inline-block"))},P=function(t){var e=t||{receiver:"",telNumber:"",address:""};$=s(l(e)),z.show({title:t?"修改地址":"添加新地址",content:$,buttons:[{type:"success",text:"确认",callback:function(){var t=F();if(!t)return!1;var e=U();if(!e)return!1;var i=N();if(!i)return!1;var s=K();return s?(V(t,e,i,s),void 0):!1}},{type:"cancel",text:"取消",callback:function(){z.hide()}}]}),I.init({selector:s(".address-adder-select",$),showOther:!0,province:{placeholder:"省份/直辖市"},other:{placeholder:"请输入其他地址信息"}}),s(".address-adder-name",$).on("blur",F),s(".address-adder-phone",$).on("blur",U),s(".address-adder-detail",$).on("blur",K),z.setPosition(),setTimeout(function(){s(".address-adder-other",$).hide()})},M=function(t){s(this).addClass("checked").siblings().removeClass("checked"),h=t.id,T.emit("selectAddress",s.extend({},t))},R=function(t,e){var i=s(e.delegateTarget);return s.ajax({url:"/customer_address/remove_submit.html",type:"get",data:{id:t.id},dataType:"json",timeout:1e4,beforeSend:r.show.bind(this,k),success:function(e){200==e.code?(u--,i.remove(),h==t.id&&(h=null),S()):_.show({title:"提示",content:e.message}),r.hide(k)},error:function(){r.hide(k),_.show({title:"提示",content:"网络错误"})
}}),!1},q=function(t,e){m=s(e.delegateTarget),v=t.id,P(t),I.setData({province:{id:t.provinceId,text:t.province},city:{id:t.cityId,text:t.city},area:{id:t.areaId,text:t.area},street:{id:t.townId,text:0==t.townId?"其他":t.town,zipCode:t.zipCode},other:0==t.townId?t.town:""},!!t.isOld),t&&0==t.townId&&setTimeout(function(){s(".address-adder-other",$).show()})},E=function(t){return t.isOld&&w.css("display","inline-block"),t.tipsHtml=t.isOld?O:"",t.ctrlHtml=t.useAppointAddr?"":A,t.className="",t.id==h||t.useAppointAddr?t.className="checked":t.isOld&&(t.className="disabled"),s(D(t)).on("click",function(){s(this).hasClass("disabled")||s(this).hasClass("checked")||M.call(this,t)}).on("click",".order-address-checkbox-delete",R.bind(this,t)).on("click",".order-address-checkbox-edit,.order-address-checkbox-perfect",q.bind(this,t))},L=function(t){var e;t.useAppointAddr?(h=t.activeAddressId,u=1,p=!0,t.appointAddress.useAppointAddr=t.useAppointAddr,e=E(t.appointAddress)):(h=t.activeAddressId?t.activeAddressId:null,u=t.addressList.length,t.addressList.sort(function(e){return e.id===t.activeAddressId?-1:1}).sort(function(t,e){return t.isOld-e.isOld}),e=s.map(t.addressList,E.bind(this)),b.show()),x.append(e),S()},F=function(){var t=s(".address-adder-name",$),e=s.trim(t.val()),i=t.parent();return e.length?g.name.test(e)?(i.removeClass("tips").attr("data-tips"," "),e):(i.addClass("tips").attr("data-tips","请输入正确的收件人姓名！"),!1):(i.addClass("tips").attr("data-tips","请输入收件人姓名！"),!1)},U=function(){var t=s(".address-adder-phone",$),e=s.trim(t.val()),i=t.parent();return e.length?g.phone.test(e)?(i.removeClass("tips").attr("data-tips"," "),e):(i.addClass("tips").attr("data-tips","请输入正确的手机号码！"),!1):(i.addClass("tips").attr("data-tips","请输入手机号码！"),!1)},K=function(){var t=s(".address-adder-detail",$),e=s.trim(t.val()),i=t.parent();return e.length?g.detail.test(e)?(i.removeClass("tips").attr("data-tips"," "),e):(i.addClass("tips").attr("data-tips","请输入正确的详细地址！"),!1):(i.addClass("tips").attr("data-tips","请输入详细地址！"),!1)},N=function(){var t=I.getData(),e=s(".address-adder-select",$);return t.province.id&&t.city.id&&t.area.id&&""!==t.street.id?(e.removeClass("tips").attr("data-tips"," "),t):(e.addClass("tips").attr("data-tips","请选择地址"),!1)},B=function(){I.on("change",function(t,e,i){"street"===t&&0===i||"other"===t?s(".address-adder-other",$).show():s(".address-adder-other",$).hide(),z.setPosition()}),x.on("click",".order-address-checkbox.add",function(){P()}),C.on("click",function(){f&&(f=!1),S(),s(this).remove()})},V=function(t,e,i,n){if(u>=10&&!v)return _.show({title:"提示",content:"最多不能超过10个地址"}),void 0;var a=i.province.text+i.city.text+(i.area.text==i.street.text||0==i.street.id?i.area.text:i.area.text+i.street.text)+i.other+n,c=i.street.zipCode||i.area.zipCode||i.city.zipCode||i.province.zipCode||0,d={provinceId:i.province.id,province:i.province.text,cityId:i.city.id,city:i.city.text,areaId:i.area.id,area:i.area.text,townId:i.street.id,town:0==i.street.id?i.other:i.street.text,zipCode:c,completeAddress:a,address:n,id:v||0,receiver:t,telNumber:e};o.get(function(t,e){return t?(_.show({title:"提示",content:t}),void 0):(s.ajax({url:"/customer_address/modify_submit.html",type:"post",data:d,dataType:"json",headers:{"X-CSRF-TOKEN":e},timeout:1e4,beforeSend:r.show.bind(null,k),success:function(t){if(200==t.code){if(v){var e=s(E(d)).replaceAll(m);M.call(e,d)}else u++,d.id=t.data,s(E(d)).appendTo(x).click(),u>3&&!v&&(f=!1,C.remove()),S();m=null,v=null,z.hide()}else _.show({title:"提示",content:t.message||t.msg});r.hide(k)},error:function(){r.hide(k),_.show({title:"提示",content:"网络错误"})}}),void 0)})},H=function(){return h},Q=function(t){L(t),B()};t.exports={init:Q,event:T,$addressModule:k,getActiveAddressId:H}},1,,function(t){t.exports=meizuStoreGlobal.underscore},function(t,e,i){i(32);var s=i(7),n=i(11),o=i(33),r=function(){return this._events={},n.apply(this,arguments),this.data={province:{id:"",text:"",zipCode:""},city:{id:"",text:"",zipCode:""},area:{id:"",text:"",zipCode:""},street:{id:"",text:"",zipCode:""},other:""},arguments.length>0?this.init.apply(this,arguments):this};r.prototype=new n,r.prototype.constructor=r,r.prototype.levelArray=["province","city","area","street"],r.prototype.cityData={province:{index:0,data:{},json:{}},city:{index:1,data:{},json:{}},area:{index:2,data:{},json:{}},street:{index:3,data:{},json:{}}},r.prototype.defaultOptions={alert:function(t){alert(t)},listValueKey:"code",listTextKey:"name",selector:"",showOther:!1,province:{placeholder:"省/直辖市",name:""},city:{placeholder:"城市",name:""},area:{placeholder:"区/县",name:""},street:{placeholder:"乡镇/街道",name:""},other:{maxlength:10,placeholder:"其他",name:""}},r.prototype.init=function(t){this.options=s.extend(!0,{},this.defaultOptions,t);var e=this,i="<div />";return this.DOMS={province:s(i),city:s(i),area:s(i),street:s(i)},this.$otherInput=s(i).addClass("mz-address-other").append('<input type="text" class="mz-input mz-address-input" placeholder="'+this.options.other.placeholder+'" '+'maxlength="'+this.options.other.maxlength+'" />').hide(),this.$otherInput.children().attr("name",this.options.other.name),this.$element=s(t.selector).append(this.DOMS.province,this.DOMS.city,this.DOMS.area,this.DOMS.street,this.$otherInput).addClass("mz-address"),s.each(this.DOMS,function(t){e.DOMS[t]=new o({selector:this,placeholder:e.options[t].placeholder,name:e.options[t].name,listValueKey:e.options.listValueKey,listTextKey:e.options.listTextKey}).on("change",e._handleChange.bind(e,t)).on("click",e._handleClick.bind(e,t))}),this.$otherInput.on("input propertychange","input",function(){e.data.other=s(this).val(),e.emit("change","other",e.data.other,null,e.getData())}),this},r.prototype.clear=function(t){t=t||0;for(var e=t;this.levelArray.length>e;e++){var i=this.levelArray[e];this.DOMS[i].clear(),this.data[i]={id:"",text:"",zipCode:""}}return this.data.other="",this.$otherInput.hide().children().val(""),this},r.prototype.setData=function(t,e,i){if(e){var n=this;this._getData("province",0,function(e){this.DOMS.province.setDownmenu(e).setData(t.province.text),this.data.province={id:n.DOMS.province.value,text:n.DOMS.province.text,zipCode:""},this._handleChange("province",n.DOMS.province.text,n.DOMS.province.value),i&&s.isFunction(i)&&i()})}else s.each(t,function(t,e){"other"!=t&&this.DOMS[t].setData(e.text,e.id)}.bind(this)),this.data=s.extend(!0,{},this.data,t),0==this.data.street.id&&this.options.showOther&&this.$otherInput.show().children().val(this.data.other),i&&s.isFunction(i)&&i();return this},r.prototype.getData=function(){return s.extend(!0,{},this.data)},r.prototype._handleClick=function(t){var e=Array.prototype.slice.call(arguments);e.push(this.getData()),this.emit.apply(this,["click"].concat(e));var i=this.cityData[t].index,s=this.levelArray[i-1]||"province",n="province"==t?0:this.data[s].id;this.DOMS[t].$ul||!n&&0!=i||this._getData(t,n,function(e){this.DOMS[t].setDownmenu(e)})},r.prototype._extendCityJson=function(t,e){var i=this;s.each(e,function(e,s){i.cityData[t].json[s[i.options.listValueKey]]=s})},r.prototype._handleChange=function(t,e,i){var s=this.cityData[t].index;if(e&&(this.data[t].id=i,this.data[t].text=e,this.data[t].zipCode=this.cityData[t].json[i].zipCode||"",this.clear(s+1),this.emit("change",t,e,i,this.getData())),s==this.levelArray.length-1)return 0==i&&this.options.showOther&&this.$otherInput.show(),void 0;var n=this.levelArray[s+1];this._getData(n,i,function(t){this.DOMS[n].setDownmenu(t),1==t.length&&(this.DOMS[n].setData(t[0][this.options.listTextKey],t[0][this.options.listValueKey]),this._handleChange(n,t[0][this.options.listTextKey],t[0][this.options.listValueKey]))})},r.prototype._getData=function(t,e,i){return e=e||0,this.cityData[t].data[e]?(i.call(this,this.cityData[t].data[e]),this.emit("data",t,this.cityData[t].data[e]),void 0):(s.ajax({url:"//area.meizu.com/area/child/query/"+e,dataType:"jsonp",success:function(s){s.success?(this.cityData[t].data[e]=s.data,this._extendCityJson(t,s.data),i.call(this,s.data),this.emit("data",t,s.data)):this.options.alert(s.errorMsg)}.bind(this),error:function(){this.options.alert("服务器忙")}.bind(this)}),void 0)},r.prototype.remove=function(){var t=this;this.clear(),s.each(this.DOMS,function(e,i){i.remove(),t.DOMS[e]=null})},t.exports=r},1,function(t,e,i){i(34);var s=i(7),n=i(11),o=function(){return this._events={},n.apply(this,arguments),arguments.length>0?this.init.apply(this,arguments):this};o.prototype=new n,o.prototype.constructor=o,o.prototype.defaultOptions={placeholder:"",select:"",text:"",value:"",name:"",listTextKey:"",listValueKey:"",data:null},o.prototype.init=function(t){return this.options=t=s.extend({},this.defaultOptions,t),this.$element=s(t.selector).addClass("mz-selectmenu"),this.$show=s('<input type="text" readonly="readonly" tabindex="-1" class="mz-downmenu-input" />').appendTo(this.$element).attr("placeholder",t.placeholder).val(t.text),this.$value=s('<input type="hidden" tabindex="-1" />').appendTo(this.$element).val(t.value).attr("name",t.name),this.$downmenu=s('<div class="mz-downmenu" />').appendTo("body"),this.setDownmenu(t.data),this.bind(),this},o.prototype.bind=function(){var t=this;this.$show.on("click",function(e){var i=s.extend({},t.options);t.emit("click",i,e),t._setPosition(),t.$downmenu.slideDown(50),t.emit("show",i,e)}),this.$show.on("blur",function(){t.beforeClose=setTimeout(function(e){var i=s.extend({},t.options);t.$downmenu.slideUp(50),t.emit("blur",i,e)},200)}),this.$downmenu.on("scroll",function(){clearTimeout(t.beforeClose)}),s(window).on("scroll",function(){t._setPosition()})},o.prototype._setPosition=function(){var t=this.$element.offset();this.$downmenu.css({top:t.top+this.$element.height(),left:t.left,width:this.$element.outerWidth()-2})},o.prototype.setData=function(t,e){if(void 0==t&&void 0==e)return this;if(void 0==t&&e){if(!this.listObject)return this;s.each(this.listObject,function(i,s){var n=this.options.listValueKey?s[this.options.listValueKey]:s;n==e&&(t=this.options.listTextKey?s[this.options.listTextKey]:i)}.bind(this))}else if(void 0==e&&t){if(!this.listObject)return this;s.each(this.listObject,function(i,s){var n=this.options.listTextKey?s[this.options.listTextKey]:i;n==t&&(e=this.options.listValueKey?s[this.options.listValueKey]:s)}.bind(this))}return this.$show.val(t),this.$value.val(e),this.options.value=e,this.options.text=t,this},o.prototype.getData=function(){var t=this;return{text:t.options.text,value:t.options.value}},o.prototype.setDownmenu=function(t){if(t){var e=this;return this.listObject=t,this.$ul=s('<ul class="mz-downmenu-list" />'),s.each(t,function(t,i){var n=this;this._text=e.options.listTextKey?this[e.options.listTextKey]:t,this._value=e.options.listValueKey?this[e.options.listValueKey]:i,s('<li class="mz-downmenu-item" />').appendTo(e.$ul).text(this._text).on("click",function(t){var i=s.extend({},e.options);e.emit("select",n._text,n._value,i,t),n._text!=e.options.text&&(e.$show.val(n._text),e.$value.val(n._value),e.options.value=n._value,e.options.text=n._text,e.emit("change",n._text,n._value,i,t)),e.$downmenu.slideUp(50)})}),this.$downmenu.html(this.$ul),this}},o.prototype.clear=function(){return this.$value.val(""),this.$show.val(""),this.$downmenu.empty(),this.options.value="",this.options.text="",delete this.$ul,this},o.prototype.remove=function(){this.clear(),this.$show.remove(),this.$value.remove(),this.$downmenu.remove()},t.exports=o},1,function(t){t.exports='<div class="address-adder-content">\n  <div class="address-adder-row clearfix">\n    <div class="address-adder-title">收货人姓名<span class="address-adder-must">*</span></div>\n    <div class="mz-input-warp"><input type="text" class="mz-input address-adder-name" placeholder="姓名长度不超过15个汉字" value="<%= receiver %>" /></div>\n    <div class="address-adder-title">收货人手机号<span class="address-adder-must">*</span></div>\n    <div class="mz-input-warp"><input type="text" class="mz-input address-adder-phone" placeholder="请输入11位手机号" value="<%= telNumber %>" /></div>\n  </div>\n  <div class="address-adder-row clearfix">\n    <div class="address-adder-title">收货人地址<span class="address-adder-must">*</span></div>\n    <div class="mz-input-warp address-adder-select"></div>\n  </div>\n  <div class="address-adder-row clearfix address-adder-other">\n    <div class="address-adder-title">其他<span class="address-adder-must">*</span></div>\n  </div>\n  <div class="address-adder-row clearfix">\n    <div class="address-adder-title">详细地址<span class="address-adder-must">*</span></div>\n    <div class="mz-input-warp"><input type="text" class="mz-input address-adder-detail" placeholder="请输入3-50个汉字的详细地址，例如路名、门牌号" value="<%= address %>" /></div>\n  </div>\n</div>\n'},function(t,e,i){i(37);var s=i(7),n=i(30),o=i(8),r=i(25),a=i(39),c=i(40),d=0,l={},p=[],u=!1,h=s("#orderProductList"),v=new o({type:"msg"}),m='<table cellpadding="0" cellspacing="0" />',f="<tbody />",y="<tr />",g=function(t){return["<thead>","<tr>",'<th class="order-product-table-name">','<div class="order-product-supplier">','供应商：<span class="order-product-supplier-name">'+t+"</span>",'<div class="order-product-supplier-tips">由“'+t+"”负责发货，并提供售后服务</div>","</div>","</th>",'<th class="order-product-table-price">单价</th>','<th class="order-product-table-num">数量</th>','<th class="order-product-table-total">小计</th>','<th class="order-product-table-express">配送方式</th>',"</tr>","</thead>"].join("")},x=["<tfoot>","<tr>",'<td colspan="5">','<div class="order-product-info">','<div class="order-product-remark">','<span class="order-product-remark-title">备注</span>','<textarea class="order-product-remark-input" placeholder="备注..." maxlength="45">',"</textarea>","</div>","</div>",'<div class="order-product-total">','合计：<span class="order-product-price red"></span>',"</div>","</td>","</tr>","</tfoot>"].join(""),b=n.template(['<td class="order-product-table-name">','<img class="order-product-image" src="<%= image %>"/>','<div  class="order-product-name">','<a target="_blank" class="order-product-link" href="<%= itemUrl %>"><%= name %></a>',"</div>","</td>"].join("")),k=['<div class="order-product-invoice clearfix">','<div class="order-product-invoice-type">','发票类型：电子发票<div class="order-product-invoice-icon"></div>',"</div>",'<div class="order-product-invoice-title">发票抬头：默认为收货人姓名</div>',"</div>"].join(""),w=['<div class="order-product-invoice clearfix">','<div class="order-product-invoice-type">',"发票类型：",'<label for="invoiceNo" class="order-product-invoice-label">','<input class="order-product-invoice-radio" type="radio" ','name="invoice" value="0" id="invoiceNo" checked="checked">',"不开具发票</label>",'<label for="invoiceYes" class="order-product-invoice-label">','<input class="order-product-invoice-radio" type="radio" ','name="invoice" value="1" id="invoiceYes">',"纸质发票</label>","</div>",'<div class="order-product-invoice-title paper">','发票抬头：<input type="text" class="order-product-invoice-input" value="个人" maxlength="45">',"</div>","</div>"].join(""),C=['<td class="order-product-table-express">','<p>快递配送：运费<span class="order-product-price red"></span></p>',"</td>"].join(""),$=n.template(['<div class="order-product-arrival">','<p><i class="order-product-arrival-icon"></i><%= text %></p>',"<p><%= beforeTime %>前下单并支付，</p>","<p>预计<strong><%= day %>（<%= date %>）</strong>送达</p>","</div>"].join("")),I=function(t,e,i){var n,o=s(x);return t>1e4?(n=s(w),i.invoiceType=0,i.invoiceTitle="个人",n.on("click",".order-product-invoice-radio",function(){var t=s(this).val(),e=s(this).parents(".order-product-invoice-type").siblings(".order-product-invoice-title");1==t?(i.invoiceType=1,e.show()):(i.invoiceType=0,e.hide())}).on("input propertychange",".order-product-invoice-input",function(){i.invoiceTitle=s(this).val()})):(n=s(k),i.invoiceType=2),o.on("input propertychange",".order-product-remark-input",function(){i.remark=s(this).val()}),o.find(".order-product-remark").before(n),o.find(".order-product-price").text(e.toFixed(2)),o},_=function(t,e){var i="";e?i=t.name:t.name&&(i=t.itemName+"<br />"+t.cspuDesc+(t.packageId?'<br /><span class="order-product-group">'+t.packageName+"</span>":""));var n=s(b({image:t.image,itemUrl:t.itemUrl,name:i}));return e&&n.attr("colspan","4"),n},T=function(t,e){var i=s('<td class="order-product-table-price" />'),n=i.append("<p />");if(n.append('<span class="order-product-price">'+t.totalPrice.toFixed(2)+"</span>"),t.reduceMoney>0&&(n.append('<span class="order-product-price cancel">'+t.totalOriginPrice.toFixed(2)+"</span>"),t.reduceItems)){var o=s('<div class="order-product-discount" />'),a=s('<div class="order-product-discount-title" />').appendTo(o),l=null;if(t.reduceItems.length>1){o.addClass("more"),a.append('优惠 <span class="order-product-price sub">'+t.reduceMoney.toFixed(2)+'</span><i class="order-product-discount-triangle"></i>');var u=s.map(t.reduceItems,function(t){return 1==t.type&&(l=t.endTime),'<li class="order-product-discount-item">'+(1==t.type?"限时折扣优惠":"套餐优惠")+' <span class="order-product-price sub">'+t.price.toFixed(2)+"</span></li>"}),h=s('<ul class="order-product-discount-downmenu">').append(u);o.append(h)}else 1==t.reduceItems.length&&(l=1==t.reduceItems[0].type?t.reduceItems[0].endTime:null,a.html((1==t.reduceItems[0].type?"限时折扣优惠":"套餐优惠")+' <span class="order-product-price sub">'+t.reduceItems[0].price.toFixed(2)+"</span>"));if(i.append(o),null!=l){e.countdown=new r({step:1e3});var v=l-d,m=s('<p class="order-product-countdown" />').text("限时特惠：剩余"+c(v).string);e.countdown.on("end",function(){p.push('"'+t.itemName+" "+t.cspuDesc+(t.packageId?" "+t.packageName:"")+'"')}).on("count",function(t){m.text("限时特惠：剩余"+c(t).string)}).count(v),i.append(m)}}var f=s('<td class="order-product-table-num">').text(t.number),y=s('<td class="order-product-table-total" />');return s('<p class="order-product-price red" />').text(t.payMoney.toFixed(2)).appendTo(y),e.number=t.number,e.skuId=t.skuId,t.packageId&&(e.packageId=t.packageId,e.packageList=s.map(t.skuInfoBoList,function(t){return t.skuId}).join(",")),[i,f,y]},z=function(t,e){var i=s(C);return i.find(".order-product-price").text(t.merchantExpressFee.toFixed(2)),t.supportFastArrival&&(u=!0,e.arrival=s(O(t.fastArrival)),i.append(e.arrival)),i},O=function(t){if(0!=t.fastArrivalStatus){var e=a(new Date(t.payDate),"hh:mm");return $({text:1==t.fastArrivalStatus?"当日达":"次日达",beforeTime:"00:00"==e?"24:00":e,day:1==t.fastArrivalStatus?"今天":"明天",date:a(new Date(t.arrivalDate),"MM月dd日")})}return'<div class="order-product-arrival" />'},A=function(t,e,i){var n,o=0;i.skus={};var r=s.map(t,function(t,r){i.skus[t.skuId]={};var a=s(y);a.append(_(t),T(t,i.skus[t.skuId])),0==r&&(n=s(z(e,i)).appendTo(a));var c=[a].concat(s.map(t.skuInfoBoList,function(t,e){var i=s(y).addClass("order-product-table-child");return 0==e&&i.addClass("first"),i.append(_(t,!0)),o++,i}));return o++,c});return n.attr("rowspan",o),r},j=function(t){var e=s.map(t,function(t){l[t.merchantId]={};var e=s(m),i=s(g(t.merchantName)),n=s(f).append(A(t.skuInfo,t,l[t.merchantId])),o=s(I(t.merchantId,t.merchantTotalMoney,l[t.merchantId]));return e.append(i,n,o)});h.html(e)},D=function(){h.on("click",".order-product-invoice-icon",function(){v.show({title:"电子发票详细介绍",content:i(41)})})},S=function(){return p},P=function(){return l},M=function(){return u},R=function(t,e){d=e,j(t),D()};t.exports={init:R,setArrival:O,getCountEndProd:S,getSupportFastArrival:M,getProductPointer:P}},1,,function(t){t.exports=function(t,e){e=e||"yyyy-MM-dd hh:mm:ss";var i={"M+":t.getMonth()+1,"d+":t.getDate(),"h+":t.getHours(),"m+":t.getMinutes(),"s+":t.getSeconds(),"q+":Math.floor((t.getMonth()+3)/3),S:t.getMilliseconds()};/(y+)/.test(e)&&(e=e.replace(RegExp.$1,(t.getFullYear()+"").substr(4-RegExp.$1.length)));for(var s in i)RegExp("("+s+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?i[s]:("00"+i[s]).substr((""+i[s]).length)));return e}},function(t){t.exports=function(t){var e=parseInt(t/864e5,10),i=parseInt((t-864e5*e)/36e5,10),s=parseInt((t-864e5*e-36e5*i)/6e4,10),n=parseInt((t-864e5*e-36e5*i-6e4*s)/1e3,10);e=e>0?10>e?"0"+e:e:0,i=i>0?10>i?"0"+i:i:0,s=s>0?10>s?"0"+s:s:0,n=n>0?10>n?"0"+n:n:0;var o=e>0?" "+e+"天"+i+"时"+s+"分"+n+"秒 ":i>0?" "+i+"时"+s+"分"+n+"秒 ":s>0?s+"分"+n+"秒 ":n+"秒 ";return{day:e,hour:i,minute:s,second:n,string:o}}},function(t){t.exports='<ul class="einvoice-detail">\n  <li class="q">为什么要选择电子发票？</li>\n  <li class="a">电子发票是纳税义务人通过互联网录入数据，然后开具给客户。电子发票获取更便捷，可重复下载，避免丢失，方便查验，售后维权更有保障。发货效率更高，退换货更方便！电子发票低碳环保，节能减排，符合加强环境保护的国家策略。选择电子发票，省力省心，更能为环境保护贡献一份力。</li>\n  <li class="q">确保电子发票具有法律效力的相关规定有哪些?</li>\n  <li class="a">根据国家税务总局关于推行通过增值税电子发票系统开具的增值税电子普通发票有关问题的公告（国家税务总局公告2015年第84号）的规定，自2016年1月1日起启用。增值税电子普通发票的开票方和受票方需要纸质发票的，可以自行打印增值税电子普通发票的版式文件，其法律效力、基本用途、基本使用规定等与税务机关监制的增值税普通发票相同。</li>\n  <li class="q">怎样收到电子发票？</li>\n  <li class="a">2016年1月1日及之后发货的订单，电子发票将在订单发货后，由系统自动发送到收货人的手机，请留意查收；如未收到，请联系客服热线:400-788-3333或进入官网咨询：<a class="einvoice-detail-link" href="http://live-i.meizu.com/live800/chatClient/chatbox.jsp?companyID=8957&configID=4&enterurl=http://store.meizu.com/explain/einvoice_help.html&pagereferrer=&info=&k=1" target="_blank">在线客服</a>，无需操作后台；2016年1月1日前发货的订单，可在官网商城用户订单详情中查看发票信息。</li>\n  <li class="q">想要传统纸质发票怎么办？</li>\n  <li class="a">魅族商城正式启用电子发票后，不支持自主更换纸质发票。</li>\n  <li class="q">电子发票短信误删了怎么办？</li>\n  <li class="a">用户可联系客服索取电子发票信息，客服热线:400-788-3333或进入官网咨询：<a class="einvoice-detail-link" href="http://live-i.meizu.com/live800/chatClient/chatbox.jsp?companyID=8957&configID=4&enterurl=http://store.meizu.com/explain/einvoice_help.html&pagereferrer=&info=&k=1" target="_blank">在线客服</a>。</li>\n  <li class="q">电子发票是否可以用于报销？</li>\n  <li class="a">电子发票打印后可用于单位报销。</li>\n  <li class="q">电子发票在哪里下载和打印？</li>\n  <li class="a">2016年1月1日及之后发货的订单，电子发票用户可以登录<a class="einvoice-detail-link" href="http://t.cn/R4cdnja" target="_blank">http://t.cn/R4cdnja</a> 凭借短信信息查询电票发票。 2016年1月1日前发货的订单，电子发票依旧在<a class="einvoice-detail-link" href="http://t.cn/Rzm3kyC" target="_blank">http://t.cn/Rzm3kyC</a> 查询。</li>\n  <li class="q">选择开具电子发票的顾客如何办理退换货流程？</li>\n  <li class="a">和原有退换货流程一样，唯一区别是电子发票的用户在办理退换货时无需用户退回电子发票，我司直接按电子发票冲红处理。</li>\n  <li class="q">电子发票可以修改发票抬头吗？</li>\n  <li class="a">目前电子发票抬头默认为收货人姓名，如需修改，请联系客服热线:400-788-3333或进入官网咨询：<a class="einvoice-detail-link" href="http://live-i.meizu.com/live800/chatClient/chatbox.jsp?companyID=8957&configID=4&enterurl=http://store.meizu.com/explain/einvoice_help.html&pagereferrer=&info=&k=1" target="_blank">在线客服</a>。</li>\n</ul>\n'},function(t,e,i){i(43);var s=i(7),n=i(44),o=i(48),r=i(52),a=0,c=0,d=0,l=0,p=null,u=null,h=null,v=s("#discount"),m=s("#discountList"),f=s("#totalRedRow"),y=s("#totalRepoRow"),g=s("#totalCouponRow"),x=s("#totalPayPrice"),b=function(t){var e=100*a,i=100*d,s=100*c,n=100*l,o=e-i-n-s;switch(t){case"repo":o+=i;break;case"coupon":o+=s;break;case"red":o+=n;break;default:}return o/100},k=function(t,e){return!!(0>=(100*b(e)-100*t)/100)},w=['<li class="order-discount-item">','<div class="order-discount-item-header">','<div class="order-discount-item-title"></div>','<div class="order-discount-item-right"></div>',"</div>",'<div class="order-discount-item-content"></div>',"</li>"].join(""),C=function(t){return['<div class="order-discount-content-mask">','<div class="order-discount-content-tips">','<div class="order-discount-content-tips-header">无法选择</div>','<div class="order-discount-content-tips-content">'+t+"</div>","</div>","</div>"].join("")},$=".order-discount-item-right",I=".order-discount-item-title",_=".order-discount-item-header",T=".order-discount-item-content",z=function(){if(n.getCouponState()){var t=c>0?'<span class="order-discount-item-price">'+c.toFixed(2)+"</span>":"";c>0?g.show():g.hide(),s($,p).html(t),s(".order-total-price",g).text(c.toFixed(2))}if(o.getRedState()){var e=l>0?'<span class="order-discount-item-price">'+l.toFixed(2)+"</span>":"";l>0?f.show():f.hide(),s($,h).html(e),s(".order-total-price",f).text(l.toFixed(2))}var i=d>0?'<span class="order-discount-item-price">'+d.toFixed(2)+"</span>":"";d>0?y.show():y.hide(),s($,u).html(i),s(".order-total-price",y).text(d.toFixed(2)),x.text(b().toFixed(2))},O=function(t,e){t=s(t);var i=s(C(e)).css({display:"none"}).appendTo(t).fadeIn(400);setTimeout(function(){i.fadeOut(400)},2e3)},A=function(){m.on("click",_,function(){var t=s(this).parent(),e=t.data("type"),i=s(this).siblings(T),n=t.hasClass("open"),o=function(t,e){var i=e.siblings(".open");i.children(T).stop(!1,!0).slideUp(400,function(){i.removeClass("open")}),t.stop(!1,!0).slideDown(400),e.addClass("open")};n?i.stop(!1,!0).slideUp(400,function(){i.parent().removeClass("open")}):"repo"!=e||r.getRepoState()?o(i,t):r.getUserRepo(o.bind(null,i,t),v)}),r.event.on("updatePrice",function(t){d=t,z()}),r.event.on("error",O)},j=function(t,e,i){a=t,p=s(w).data("type","coupon"),n.init(k,e,s(T,p)),n.getCouponState()&&(s(I,p).text("使用优惠券"),p.addClass("open").appendTo(m),n.event.on("updatePrice",function(t){c=t,z()}),n.event.on("error",O)),h=s(w).data("type","red"),o.init(k,i,s(T,h)),o.getRedState()&&(s(I,h).text("使用红包"),h.appendTo(m),o.event.on("updatePrice",function(t){l=t,z()}),o.event.on("error",O)),u=s(w).data("type","repo"),r.init(k,s(T,u)),s(I,u).text("使用回购券"),u.appendTo(m),A()};t.exports={init:j,coupon:n,red:o,repo:r}},1,function(t,e,i){i(45);var s=i(7),n=i(30),o=i(11),r=i(39),a=null,c=null,d=!1,l=0,p={},u=new o,h=s('<ul class="order-discount-coupon-list clearfix" />'),v=n.template(i(47)),m=function(){s.each(p,function(){s(this).removeClass("checked")}),c=null,l=0,u.emit("updatePrice",l)},f=function(t){return t.startDate=r(new Date(t.start),"yyyy.MM.dd hh:mm"),t.endDate=r(new Date(t.end),"yyyy.MM.dd hh:mm"),p[t.couponAcquirementId]=s(v(t)).on("click",function(e){if(s(e.target).hasClass("order-discount-coupon-range-link"))return window.open("http://lists.meizu.com/page/couponItems/"+t.couponId+".html","_blank"),!1;if(s(this).hasClass("checked"))s(this).removeClass("checked"),c=null,l=0,u.emit("updatePrice",l);else{var i=a(t.reductionQuota,"coupon");i?u.emit("error","body","抵扣金额超过订单金额"):(s(this).addClass("checked").siblings(".checked").removeClass("checked"),c=t.couponAcquirementId,l=t.reductionQuota,u.emit("updatePrice",l))}}),p[t.couponAcquirementId]},y=function(t,e){return e.reductionQuota-t.reductionQuota},g=function(t){var e=0,i=null,n=[],o=[];s.each(t,function(t,e){1==e.couponType?n.push(e):o.push(e)}),n.sort(y),o.sort(y),t=n.concat(o);var r=s.map(t,function(t){var s=a(t.reductionQuota,"coupon");return!s&&t.reductionQuota>e&&(e=t.reductionQuota,i=t.couponAcquirementId),f(t)});h.append(r),setTimeout(function(){i&&p[i].click()})},x=function(){return d},b=function(t,e,i){a=t,e&&e.length&&(d=!0,g(e),i.addClass("order-discount-coupon").html(h))},k=function(){return c};t.exports={init:b,event:u,clearCoupon:m,getCouponState:x,getUseCouponId:k}},1,,function(t){t.exports='<li class="order-discount-coupon-item">\n  <div class="order-discount-coupon-tick <%= couponType == 1 ? \'single\' : \'\' %>">\n    <div class="order-discount-coupon-top clearfix">\n      <div class="order-discount-coupon-top-left">\n        <div class="order-discount-coupon-price"><%= reductionQuota %></div>\n        <div class="order-discount-coupon-type"><%= couponType == 1 ? \'单品券\' : \'多品券\' %></div>\n        </div>\n      <div class="order-discount-coupon-top-right">\n        <div class="order-discount-coupon-title" title="<%= name %>优惠券"><%= name %>优惠券</div>\n        <div class="order-discount-coupon-desc">满<%= consumptionQuota %>可用</div>\n        </div>\n      </div>\n    <div class="order-discount-coupon-bottom">\n      <div class="order-discount-coupon-time"><%= startDate %> - <%= endDate %></div>\n      <div class="clearfix">\n        <div class="order-discount-coupon-range-text" title="适用范围：<%= itemDesc %>">适用范围：<%= itemDesc %></div>\n        <a class="order-discount-coupon-range-link">查看适用></a>\n        </div>\n      </div>\n    </div>\n  <div class="order-discount-coupon-footer">\n    <div class="order-discount-coupon-checkbox"></div>\n  </div>\n</li>\n'},function(t,e,i){i(49);var s=i(7),n=i(30),o=i(11),r=i(39),a=null,c=!1,d=new o,l=0,p=null,u={},h=n.template(i(51)),v=s('<ul class="order-discount-red-list clearfix" />'),m=function(){s.each(u,function(){s(this).removeClass("checked")}),p=null,l=0,d.emit("updatePrice",l)},f=function(t){return t.startDate=r(new Date(t.start),"yyyy.MM.dd hh:mm"),t.endDate=r(new Date(t.end),"yyyy.MM.dd hh:mm"),u[t.redEnvelopeAcquirementId]=s(h(t)).on("click",function(){if(s(this).hasClass("checked"))s(this).removeClass("checked"),p=null,l=0,d.emit("updatePrice",l);else{var e=a(t.quota,"red");e?d.emit("error","body","抵扣金额超过订单金额"):(s(this).addClass("checked").siblings(".checked").removeClass("checked"),p=t.redEnvelopeAcquirementId,l=t.quota,d.emit("updatePrice",l))}}),u[t.redEnvelopeAcquirementId]},y=function(t){t.sort(function(t,e){return e.quota-t.quota});var e=s.map(t,f);v.append(e)},g=function(){return c},x=function(t,e,i){a=t,e&&e.length&&(c=!0,y(e),i.addClass("order-discount-red").append(v))},b=function(){return p};t.exports={init:x,event:d,clearRed:m,getRedState:g,getUseRedId:b}},1,,function(t){t.exports='<li class="order-discount-red-item">\n  <div class="order-discount-red-tick">\n    <div class="order-discount-red-top clearfix">\n      <div class="order-discount-red-price"><%= quota %></div>\n      <div class="order-discount-red-name" title="<%= name %>红包"><%= name %>红包</div>\n    </div>\n    <div class="order-discount-red-time"><%= startDate %> - <%= endDate %></div>\n  </div>\n  <div class="order-discount-red-footer">\n    <div class="order-discount-red-checkbox"></div>\n  </div>\n</li>\n'},function(t,e,i){i(53);var s=i(7),n=i(30),o=i(8),r=i(26)(),a=i(12),c=i(11),d=n.template(['已选择<span class="order-discount-repo-selected-num"><%= repoNum %></span>',"张回购券（可多张叠加使用），总抵现",'<span class="order-discount-repo-selected-price"><%= repoPrice %></span>'].join("")),l='<ul class="order-discount-repo-list" />',p=['<div class="order-discount-repo-enter-row">','券号：<input type="text" class="order-discount-repo-enter-input">','密码：<input type="password" class="order-discount-repo-enter-input">','<div class="mz-btn success">确定</div>','<span class="order-discount-repo-tips"></span>',"</div>"].join(""),u=/^.{18}$/,h=!1,v=new o({type:"tips"}),m=new c,f=null,y=0,g=0,x={userTicks:{},inputTicks:{}},b={},k=null,w=s(l),C=s(l),$=s('<span class="order-discount-repo-enter-title">点击输入回购券</span>'),I=s('<div class="order-discout-repo-text" />'),_=s(p),T=s('<div class="order-discount-repo-enter-content" />').append(_,C),z=n.template(i(56)),O=function(){s.each(b,function(){s(this).removeClass("checked")}),y=0,g=0,x={userTicks:{},inputTicks:{}},S(),m.emit("updatePrice",g)},A=function(t,e,i){if(i.data("isSelected"))i.data("isSelected",!1),y--,g=(100*g-100*e)/100,i.removeClass("checked"),x=t;else{var s=f(e);s?m.emit("error","body","抵扣金额超过订单金额"):(i.data("isSelected",!0),y++,g=(100*g+100*e)/100,i.addClass("checked"),x=t)}S(y,g),m.emit("updatePrice",g)},j=function(t,e){s.ajax({url:"/order/get_tickets.html",beforeSend:a.show.bind(null,e),timeout:1e4,success:function(i){a.hide(e),200==i.code?(h=!0,D(i.data),t()):v.show({title:"提示",content:i.message})},error:function(){a.hide(e),v.show({title:"提示",content:"网络错误"})}})},D=function(t){if(!s.isEmptyObject(t)){var e=s.map(t,function(t,e){return b[e]=s(z({price:t,sn:e.replace(e.substring(4,14),"****")})).on("click",function(){var i=s.extend(!0,{},x);s(this).data("isSelected")?delete i.userTicks[e]:i.userTicks[e]=t,A(i,t,s(this))}),b[e]});w.append(e)}},S=function(){I.html(d({repoNum:y,repoPrice:g.toFixed(2)}))},P=function(t,e){r.get(function(i,n){return i?(v.show({title:"提示",content:i}),void 0):(s.ajax({url:"/orders/query_repo.html",type:"post",headers:{"X-CSRF-TOKEN":n},data:{tick:t,password:e},beforeSend:a.show.bind(null,k),timeout:1e4,success:function(i){a.hide(k),200==i.code?(s("input[type=text]",_).val(""),s("input[type=password]",_).val(""),b[t]=s(z({price:i.data.tickPrice,sn:t.replace(t.substring(4,14),"****")})).on("click",function(){var n=s.extend(!0,{},x);s(this).data("isSelected")?delete n.inputTicks[t]:n.inputTicks[t]=e,A(n,i.data.tickPrice,s(this))
}).appendTo(C)):m.emit("error","body",i.message||i.msg)},error:function(){a.hide(k),m.emit("error","body","网络错误")}}),void 0)})},M=function(){var t=!1;$.on("click",function(){t?T.stop(!1,!0).slideUp(400,function(){t=!1}):T.stop(!1,!0).slideDown(400,function(){t=!0})}),_.on("click",".mz-btn",function(){var t=s("input[type=text]",_).val(),e=s("input[type=password]",_).val();if(u.test(t)&&""!=s.trim(e)){if(b[t])return m.emit("error","body","该券已添加，请勿重复添加！"),void 0;P(t,e)}else m.emit("error","body","请输入正确的卡号和密码！")})},R=function(){return h},q=function(){return y},E=function(){return x},L=function(t,e){f=t,S(),k=e.addClass("order-discount-repo").append(I,w,s("<p />").append($),T),M()};t.exports={init:L,event:m,clearRepo:O,getUserRepo:j,getRepoState:R,getUseRepoCount:q,getSelectedRepo:E}},1,,,function(t){t.exports='<li class="order-discount-repo-checkbox">\n  <div class="order-discount-repo-checkbox-title"></div>\n  <div class="order-discount-repo-checkbox-price"><%= price %></div>\n  <div class="order-discount-repo-checkbox-sn"><%= sn %></div>\n  <div class="order-discount-repo-checkbox-checked"></div>\n</li>\n'}]));